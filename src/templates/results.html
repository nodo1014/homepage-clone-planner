{% extends "base.html" %}

{% block title %}{{ title }}{% endblock %}

{% block content %}
<main class="main-content">
    <!-- ë””ë²„ê¹… ì •ë³´ (ê°œë°œ ì¤‘ì—ë§Œ í‘œì‹œ) -->
    {% if True %}
    <div class="debug-info" style="background: #f8f9fa; border: 1px solid #ccc; padding: 10px; margin-bottom: 20px; font-family: monospace; font-size: 12px;">
        <h4>ë””ë²„ê¹… ì •ë³´ (ê°œë°œìš©)</h4>
        <ul>
            <li>URL: {{ results.url }}</li>
            <li>ì œëª©: {{ results.title }}</li>
            <li>ì„¤ëª…: {{ results.description }}</li>
            <li>ë‚´ë¹„ê²Œì´ì…˜ í•­ëª©: {{ results.nav_items|length }}</li>
            <li>ì»´í¬ë„ŒíŠ¸: {{ results.components|length }}</li>
            <li>ì»¬ëŸ¬: {{ results.colors|length }}</li>
            <li>ë ˆì´ì•„ì›ƒ: {{ results.layout_type }}</li>
            <li>ëª©ì—… ì´ë¯¸ì§€: {{ results.mockups|length }}</li>
        </ul>
    </div>
    {% endif %}
    
    <div class="results-header">
        <h1>{{ results.title }}</h1>
        <p class="url"><a href="{{ results.url }}" target="_blank">{{ results.url }}</a></p>
        <p class="description">{{ results.description }}</p>
        <p class="created-at">ë¶„ì„ ì¼ì‹œ: {{ results.created_at }}</p>
    </div>
    
    <section class="container">
        <div class="card">
            <h1>ë¶„ì„ ê²°ê³¼: {{ results.title }}</h1>
            <p>{{ results.url }} ì›¹ì‚¬ì´íŠ¸ ë¶„ì„ ê²°ê³¼ì…ë‹ˆë‹¤.</p>
            <p><small>ë¶„ì„ ì™„ë£Œ: {{ results.created_at }}</small></p>
            
            <!-- íƒ­ ì„ íƒ ë©”ë‰´ -->
            <div class="tabs" x-data="{ activeTab: 'tab-1' }">
                <div class="tab" 
                     :class="{ 'active': activeTab === 'tab-1' }" 
                     @click="activeTab = 'tab-1'">
                    ğŸ—’ï¸ ê¸°íšì„œ
                </div>
                <div class="tab" 
                     :class="{ 'active': activeTab === 'tab-2' }" 
                     @click="activeTab = 'tab-2'">
                    ğŸ¨ ë””ìì¸
                </div>
                <div class="tab" 
                     :class="{ 'active': activeTab === 'tab-3' }" 
                     @click="activeTab = 'tab-3'">
                    ğŸ’¡ ì•„ì´ë””ì–´
                </div>
            </div>
            
            <!-- ë…¸ì…˜ ë‚´ë³´ë‚´ê¸° ê²°ê³¼ ë©”ì‹œì§€ í‘œì‹œ ì˜ì—­ -->
            <div id="notion-export-result" style="margin: 1rem 0; display: none;"></div>
            
            <!-- êµ¬ê¸€ ë“œë¼ì´ë¸Œ ë‚´ë³´ë‚´ê¸° ê²°ê³¼ ë©”ì‹œì§€ í‘œì‹œ ì˜ì—­ -->
            <div id="gdrive-export-result" style="margin: 1rem 0; display: none;"></div>
            
            <!-- íƒ­ ë‚´ìš© -->
            <div class="tab-content" x-show="activeTab === 'tab-1'">
                <article>
                    <h2>ğŸ—’ï¸ ê¸°íšì„œ</h2>
                    <h3>ì‚¬ì´íŠ¸ ë¶„ì„</h3>
                    <p><strong>ëª©ì :</strong> {{ results.description }}</p>
                    <p><strong>ê°œìš”:</strong> {{ results.overview }}</p>
                    
                    <h3>í˜ì´ì§€ êµ¬ì¡°</h3>
                    <h4>ë©”ë‰´ ì²´ê³„</h4>
                    <ul>
                        {% if results.nav_items %}
                            {% for item in results.nav_items %}
                            <li>{{ item.title }}</li>
                            {% endfor %}
                        {% else %}
                            <li>Home</li>
                            <li>About</li>
                            <li>Services</li>
                            <li>Contact</li>
                        {% endif %}
                    </ul>
                    
                    <h4>í•µì‹¬ í˜ì´ì§€</h4>
                    {% if results.page_structure %}
                        <ol>
                            {% for page in results.page_structure %}
                            <li>
                                <strong>{{ page.name }}:</strong> {{ page.description }}
                                {% if page.components %}
                                <ul>
                                    {% for component in page.components %}
                                    <li>{{ component }}</li>
                                    {% endfor %}
                                </ul>
                                {% endif %}
                            </li>
                            {% endfor %}
                        </ol>
                    {% else %}
                        <ol>
                            <li><strong>í™ˆí˜ì´ì§€:</strong> ì£¼ìš” ì„œë¹„ìŠ¤ ë° ê°€ì¹˜ ì œì•ˆ ì†Œê°œ</li>
                            <li><strong>ì„œë¹„ìŠ¤ í˜ì´ì§€:</strong> ìƒì„¸ ì„œë¹„ìŠ¤ ì •ë³´ ì œê³µ</li>
                            <li><strong>ì—°ë½ì²˜ í˜ì´ì§€:</strong> ë¬¸ì˜ ì–‘ì‹ ë° ì—°ë½ì²˜ ì •ë³´</li>
                        </ol>
                    {% endif %}
                    
                    <h3>ê°œë°œ ê°€ì´ë“œ</h3>
                    <h4>ê¸°ìˆ  ìŠ¤íƒ</h4>
                    {% if results.tech_stack %}
                        <ul>
                            {% for tech in results.tech_stack %}
                            <li>{{ tech }}</li>
                            {% endfor %}
                        </ul>
                    {% else %}
                        <ul>
                            <li>í”„ë¡ íŠ¸ì—”ë“œ: HTML, CSS, JavaScript</li>
                            <li>ë°±ì—”ë“œ: í•„ìš”ì— ë”°ë¼ API ì„œë²„ êµ¬í˜„</li>
                            <li>ë¼ì´ë¸ŒëŸ¬ë¦¬: ë°˜ì‘í˜• ë””ìì¸ì„ ìœ„í•œ í”„ë ˆì„ì›Œí¬</li>
                        </ul>
                    {% endif %}
                    
                    <h4>ê°œë°œ ë‹¨ê³„</h4>
                    <ol>
                        <li>ê¸°ë³¸ êµ¬ì¡° ë° ë ˆì´ì•„ì›ƒ êµ¬í˜„</li>
                        <li>í•µì‹¬ ê¸°ëŠ¥ êµ¬í˜„</li>
                        <li>ë””ìì¸ ë° UI ì™„ì„±</li>
                        <li>í…ŒìŠ¤íŠ¸ ë° ìµœì í™”</li>
                    </ol>
                    
                    <h4>AI ë¶„ì„ ê¸°ë°˜ ì œì•ˆ</h4>
                    <div class="ai-insights">
                        {{ results.recommendations|safe }}
                    </div>
                    
                    <div class="grid">
                        <div>
                            <a href="/download/{{ result_id }}/plan" role="button" class="outline">ê¸°íšì„œ ë‹¤ìš´ë¡œë“œ (MD)</a>
                        </div>
                        <div>
                            <a href="/export/{{ result_id }}/markdown" role="button" class="secondary outline">ë‚´ë³´ë‚´ê¸°</a>
                        </div>
                        <div>
                            <button 
                                hx-get="/export/{{ result_id }}/notion"
                                hx-target="#notion-export-result"
                                hx-indicator="#notion-loading"
                                class="secondary outline">ë…¸ì…˜ìœ¼ë¡œ ë‚´ë³´ë‚´ê¸°</button>
                        </div>
                        <div>
                            <button 
                                hx-get="/export/{{ result_id }}/gdrive"
                                hx-target="#gdrive-export-result"
                                hx-indicator="#gdrive-loading"
                                class="secondary outline">êµ¬ê¸€ ë“œë¼ì´ë¸Œë¡œ ë‚´ë³´ë‚´ê¸°</button>
                        </div>
                    </div>
                </article>
            </div>
            
            <div class="tab-content" x-show="activeTab === 'tab-2'">
                <article>
                    <h2>ğŸ¨ ë””ìì¸</h2>
                    
                    <h3>ìƒ‰ìƒ íŒ”ë ˆíŠ¸</h3>
                    <div class="color-palette">
                        {% if results.colors %}
                            {% for color in results.colors %}
                                {% if color.hex %}
                                <div class="color-box" style="background-color: {{ color.hex }}">
                                    <span>{{ color.hex }}</span>
                                </div>
                                {% elif color.color %}
                                <div class="color-box" style="background-color: {{ color.color }}">
                                    <span>{{ color.color }}</span>
                                </div>
                                {% endif %}
                            {% endfor %}
                        {% else %}
                            <div class="color-box" style="background-color: #3949AB;">
                                <span>#3949AB</span>
                            </div>
                            <div class="color-box" style="background-color: #5C6BC0;">
                                <span>#5C6BC0</span>
                            </div>
                            <div class="color-box" style="background-color: #7986CB;">
                                <span>#7986CB</span>
                            </div>
                            <div class="color-box" style="background-color: #C5CAE9;">
                                <span>#C5CAE9</span>
                            </div>
                            <div class="color-box" style="background-color: #FFFFFF; color: #212121; text-shadow: none;">
                                <span>#FFFFFF</span>
                            </div>
                            <div class="color-box" style="background-color: #212121;">
                                <span>#212121</span>
                            </div>
                        {% endif %}
                    </div>
                    
                    <h3>UI ì»´í¬ë„ŒíŠ¸ ë¶„ì„</h3>
                    <ul>
                        {% if results.components %}
                            {% for component in results.components %}
                            <li><strong>{{ component.type }}:</strong> {{ component.description }}</li>
                            {% endfor %}
                        {% else %}
                            <li><strong>ë‚´ë¹„ê²Œì´ì…˜:</strong> ìƒë‹¨ ê³ ì • ë©”ë‰´ë°”, ëª¨ë°”ì¼ í–„ë²„ê±° ë©”ë‰´</li>
                            <li><strong>ë²„íŠ¼:</strong> ê¸°ë³¸, ê°•ì¡°, ì•„ì›ƒë¼ì¸ ìŠ¤íƒ€ì¼</li>
                            <li><strong>ì¹´ë“œ:</strong> ê·¸ë¦¼ì íš¨ê³¼ê°€ ìˆëŠ” ì»¨í…ì¸  ì¹´ë“œ</li>
                            <li><strong>í¼:</strong> ë¼ë²¨ ìƒë‹¨ ë°°ì¹˜, ì‹¤ì‹œê°„ ìœ íš¨ì„± ê²€ì‚¬</li>
                        {% endif %}
                    </ul>
                    
                    <h3>ë ˆì´ì•„ì›ƒ ìœ í˜•</h3>
                    <p><strong>{{ results.layout_type|default("ë°˜ì‘í˜• ê·¸ë¦¬ë“œ ë ˆì´ì•„ì›ƒ") }}</strong></p>
                    
                    <h3>AI ë””ìì¸ ì¸ì‚¬ì´íŠ¸</h3>
                    <div class="ai-insights">
                        {{ results.design_insights|safe }}
                    </div>
                    
                    <h3>ì ‘ê·¼ì„± ì ê²€ ë° ê°œì„  ì œì•ˆ</h3>
                    <div class="accessibility-analysis">
                        {% if results.accessibility_analysis %}
                        <div class="grid">
                            <div>
                                <h4>WCAG ì ‘ê·¼ì„± ì¤€ìˆ˜ ìˆ˜ì¤€</h4>
                                <div class="progress-container">
                                    <div class="progress-bar" style="width: {{ results.accessibility_analysis.score }}%"></div>
                                </div>
                                <p>{{ results.accessibility_analysis.score }}% - {{ results.accessibility_analysis.level }}</p>
                            </div>
                            <div>
                                <h4>ì£¼ìš” ì ‘ê·¼ì„± ì´ìŠˆ</h4>
                                <ul>
                                    {% for issue in results.accessibility_analysis.issues %}
                                    <li>{{ issue }}</li>
                                    {% endfor %}
                                </ul>
                            </div>
                        </div>
                        <h4>ê°œì„  ì œì•ˆ</h4>
                        <ul>
                            {% for suggestion in results.accessibility_analysis.suggestions %}
                            <li>{{ suggestion }}</li>
                            {% endfor %}
                        </ul>
                        {% else %}
                        <div class="ai-insights">
                            <p><strong>ìƒ‰ìƒ ëŒ€ë¹„:</strong> ìƒ‰ìƒ ê°„ ì¶©ë¶„í•œ ëŒ€ë¹„ë¥¼ í™•ë³´í•˜ì—¬ ì‹œê° ì¥ì• ê°€ ìˆëŠ” ì‚¬ìš©ìë„ ì½˜í…ì¸ ë¥¼ ì¸ì‹í•  ìˆ˜ ìˆë„ë¡ í•´ì•¼ í•©ë‹ˆë‹¤. íŠ¹íˆ ë°°ê²½ìƒ‰ê³¼ í…ìŠ¤íŠ¸ ìƒ‰ìƒì˜ ëŒ€ë¹„ê°€ WCAG ê¸°ì¤€ì„ ì¶©ì¡±í•˜ëŠ”ì§€ í™•ì¸í•˜ì„¸ìš”.</p>
                            <p><strong>í‚¤ë³´ë“œ ì ‘ê·¼ì„±:</strong> ëª¨ë“  ê¸°ëŠ¥ì´ í‚¤ë³´ë“œë§Œìœ¼ë¡œ ì‚¬ìš© ê°€ëŠ¥í•´ì•¼ í•©ë‹ˆë‹¤. í‚¤ë³´ë“œ ì´ˆì  í‘œì‹œë¥¼ ëª…í™•íˆ í•˜ê³ , íƒ­ ìˆœì„œê°€ ë…¼ë¦¬ì ì¸ì§€ í™•ì¸í•˜ì„¸ìš”.</p>
                            <p><strong>ëŒ€ì²´ í…ìŠ¤íŠ¸:</strong> ëª¨ë“  ì´ë¯¸ì§€ì— ì ì ˆí•œ ëŒ€ì²´ í…ìŠ¤íŠ¸ë¥¼ ì œê³µí•˜ì—¬ ìŠ¤í¬ë¦° ë¦¬ë” ì‚¬ìš©ìê°€ ë‚´ìš©ì„ ì´í•´í•  ìˆ˜ ìˆë„ë¡ í•´ì•¼ í•©ë‹ˆë‹¤.</p>
                            <p><strong>ë¬¸ì„œ êµ¬ì¡°:</strong> ì‹œë§¨í‹± HTML ìš”ì†Œë¥¼ ì‚¬ìš©í•˜ê³  ì˜¬ë°”ë¥¸ í—¤ë”© êµ¬ì¡°ë¥¼ ìœ ì§€í•˜ì—¬ ìŠ¤í¬ë¦° ë¦¬ë”ê°€ ë¬¸ì„œë¥¼ ì˜¬ë°”ë¥´ê²Œ í•´ì„í•  ìˆ˜ ìˆë„ë¡ í•˜ì„¸ìš”.</p>
                        </div>
                        {% endif %}
                    </div>
                    
                    <h3>ëª©ì—… ì´ë¯¸ì§€</h3>
                    <div class="mockup-container">
                        {% if results.mockups.homepage %}
                        <h4>í™ˆí˜ì´ì§€ ëª©ì—…</h4>
                        <img src="{{ results.mockups.homepage }}" alt="í™ˆí˜ì´ì§€ ëª©ì—…" class="mockup-image">
                        {% endif %}
                        
                        {% if results.mockups.services %}
                        <h4>ì„œë¹„ìŠ¤ í˜ì´ì§€ ëª©ì—…</h4>
                        <img src="{{ results.mockups.services }}" alt="ì„œë¹„ìŠ¤ í˜ì´ì§€ ëª©ì—…" class="mockup-image">
                        {% endif %}
                    </div>
                    
                    <div class="grid">
                        <div>
                            <a href="/download/{{ result_id }}/design" role="button" class="outline">ë””ìì¸ ìš”ì†Œ ë‹¤ìš´ë¡œë“œ</a>
                        </div>
                        <div>
                            <a href="/export/{{ result_id }}/images" role="button" class="secondary outline">ì´ë¯¸ì§€ ë‚´ë³´ë‚´ê¸°</a>
                        </div>
                        <div>
                            <button 
                                hx-get="/export/{{ result_id }}/notion"
                                hx-target="#notion-export-result"
                                hx-indicator="#notion-loading"
                                class="secondary outline">ë…¸ì…˜ìœ¼ë¡œ ë‚´ë³´ë‚´ê¸°</button>
                        </div>
                        <div>
                            <button 
                                hx-get="/export/{{ result_id }}/gdrive"
                                hx-target="#gdrive-export-result"
                                hx-indicator="#gdrive-loading"
                                class="secondary outline">êµ¬ê¸€ ë“œë¼ì´ë¸Œë¡œ ë‚´ë³´ë‚´ê¸°</button>
                        </div>
                    </div>
                </article>
            </div>
            
            <div class="tab-content" x-show="activeTab === 'tab-3'">
                <article>
                    <h2>ğŸ’¡ ì•„ì´ë””ì–´</h2>
                    
                    <h3>AI ê¸°ëŠ¥ ê°œì„  ì¸ì‚¬ì´íŠ¸</h3>
                    <div class="ai-insights">
                        {{ results.functional_insights|safe }}
                    </div>
                    
                    <h3>ë¹„ì¦ˆë‹ˆìŠ¤ ëª¨ë¸ í™•ì¥ ë°©ì•ˆ</h3>
                    <ol>
                        {% if results.business_ideas %}
                            {% for idea in results.business_ideas %}
                            <li>
                                <h4>{{ idea.title }}</h4>
                                <p>{{ idea.description }}</p>
                            </li>
                            {% endfor %}
                        {% else %}
                            <li>
                                <h4>ì„œë¹„ìŠ¤ ì—…ê·¸ë ˆì´ë“œ ì „ëµ</h4>
                                <p>ê¸°ì¡´ ì„œë¹„ìŠ¤ë¥¼ í™•ì¥í•˜ì—¬ í”„ë¦¬ë¯¸ì—„ í‹°ì–´ë¥¼ ì œê³µí•©ë‹ˆë‹¤. ê³ ê¸‰ ë¶„ì„ ë„êµ¬, ìš°ì„  ì§€ì›, ì¶”ê°€ ê¸°ëŠ¥ ë“±ì„ í¬í•¨í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>
                            </li>
                            <li>
                                <h4>Freemium ëª¨ë¸ ë„ì…</h4>
                                <p>ê¸°ë³¸ ì„œë¹„ìŠ¤ëŠ” ë¬´ë£Œë¡œ ì œê³µí•˜ê³ , ê³ ê¸‰ ê¸°ëŠ¥ì€ êµ¬ë… ëª¨ë¸ë¡œ ì „í™˜í•©ë‹ˆë‹¤. ì´ë¥¼ í†µí•´ ì‚¬ìš©ì ê¸°ë°˜ì„ í™•ëŒ€í•˜ê³  ìˆ˜ìµì„ ì°½ì¶œí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>
                            </li>
                        {% endif %}
                    </ol>
                    
                    <h3>ì‘ìš© ì„œë¹„ìŠ¤ ì•„ì´ë””ì–´</h3>
                    <ul>
                        {% if results.extension_services %}
                            {% for service in results.extension_services %}
                            <li>
                                <h4>{{ service.title }}</h4>
                                <p>{{ service.description }}</p>
                            </li>
                            {% endfor %}
                        {% else %}
                            <li>
                                <h4>ëª¨ë°”ì¼ ì•± ê°œë°œ</h4>
                                <p>í˜„ì¬ ì›¹ ì„œë¹„ìŠ¤ë¥¼ ëª¨ë°”ì¼ ì•±ìœ¼ë¡œ í™•ì¥í•˜ì—¬ ì‚¬ìš©ì ì ‘ê·¼ì„±ì„ í–¥ìƒì‹œí‚µë‹ˆë‹¤.</p>
                            </li>
                            <li>
                                <h4>API ì„œë¹„ìŠ¤ ì œê³µ</h4>
                                <p>ë°ì´í„°ì™€ ê¸°ëŠ¥ì„ API í˜•íƒœë¡œ ì œê³µí•˜ì—¬ ê°œë°œì ìƒíƒœê³„ë¥¼ êµ¬ì¶•í•©ë‹ˆë‹¤.</p>
                            </li>
                            <li>
                                <h4>AI ê¸°ë°˜ ì¶”ì²œ ì‹œìŠ¤í…œ</h4>
                                <p>ì‚¬ìš©ì ë°ì´í„°ë¥¼ ë¶„ì„í•˜ì—¬ ë§ì¶¤í˜• ì½˜í…ì¸ ì™€ ì„œë¹„ìŠ¤ë¥¼ ì¶”ì²œí•©ë‹ˆë‹¤.</p>
                            </li>
                        {% endif %}
                    </ul>
                    
                    <h3>í™•ì¥ ëª©ì—… ì•„ì´ë””ì–´</h3>
                    <div class="mockup-container">
                        <h4>ëª¨ë°”ì¼ ì•± ëª©ì—…</h4>
                        <img src="https://placehold.co/400x800" alt="ëª¨ë°”ì¼ ì•± ëª©ì—…" class="mockup-image">
                    </div>
                    
                    <div class="grid">
                        <div>
                            <a href="/download/{{ result_id }}/ideas" role="button" class="outline">ì•„ì´ë””ì–´ ë‹¤ìš´ë¡œë“œ</a>
                        </div>
                        <div>
                            <a href="/export/{{ result_id }}/pdf" role="button" class="secondary outline">PDFë¡œ ë‚´ë³´ë‚´ê¸°</a>
                        </div>
                        <div>
                            <button 
                                hx-get="/export/{{ result_id }}/notion"
                                hx-target="#notion-export-result"
                                hx-indicator="#notion-loading"
                                class="secondary outline">ë…¸ì…˜ìœ¼ë¡œ ë‚´ë³´ë‚´ê¸°</button>
                        </div>
                        <div>
                            <button 
                                hx-get="/export/{{ result_id }}/gdrive"
                                hx-target="#gdrive-export-result"
                                hx-indicator="#gdrive-loading"
                                class="secondary outline">êµ¬ê¸€ ë“œë¼ì´ë¸Œë¡œ ë‚´ë³´ë‚´ê¸°</button>
                        </div>
                    </div>
                </article>
            </div>
            
            <!-- ë…¸ì…˜ ë‚´ë³´ë‚´ê¸° ë¡œë”© í‘œì‹œ -->
            <div id="notion-loading" class="htmx-indicator" style="display:none; text-align:center; margin: 1rem 0;">
                <div class="spinner" aria-label="ë…¸ì…˜ìœ¼ë¡œ ë‚´ë³´ë‚´ê¸° ì¤‘..."></div>
                <p>ë…¸ì…˜ìœ¼ë¡œ ë‚´ë³´ë‚´ê¸° ì¤‘...</p>
            </div>
            
            <!-- êµ¬ê¸€ ë“œë¼ì´ë¸Œ ë‚´ë³´ë‚´ê¸° ë¡œë”© í‘œì‹œ -->
            <div id="gdrive-loading" class="htmx-indicator" style="display:none; text-align:center; margin: 1rem 0;">
                <div class="spinner" aria-label="êµ¬ê¸€ ë“œë¼ì´ë¸Œë¡œ ë‚´ë³´ë‚´ê¸° ì¤‘..."></div>
                <p>êµ¬ê¸€ ë“œë¼ì´ë¸Œë¡œ ë‚´ë³´ë‚´ê¸° ì¤‘...</p>
            </div>
            
            <!-- ì´ë©”ì¼ ì „ì†¡ í¼ -->
            <div class="email-form-container" style="margin-top: 2rem; padding-top: 1.5rem; border-top: 1px solid #eee;">
                <h3>ê²°ê³¼ ì´ë©”ì¼ë¡œ ë°›ê¸°</h3>
                
                <form hx-post="/send-email/{{ result_id }}" 
                      hx-target="#email-result" 
                      hx-swap="innerHTML"
                      hx-indicator="#email-loading">
                    <div class="grid">
                        <div>
                            <input type="email" name="email" placeholder="ì´ë©”ì¼ ì£¼ì†Œ" required>
                        </div>
                        <div>
                            <button type="submit">ì´ë©”ì¼ë¡œ ë°›ê¸°</button>
                        </div>
                    </div>
                    
                    <!-- ì´ë©”ì¼ ì „ì†¡ ìƒíƒœ ë° ê²°ê³¼ ë©”ì‹œì§€ -->
                    <div id="email-loading" class="htmx-indicator" style="display:none; text-align:center; margin-top:1rem;">
                        <div class="spinner" aria-label="ì´ë©”ì¼ ì „ì†¡ ì¤‘..."></div>
                        <p>ì´ë©”ì¼ ì „ì†¡ ì¤‘...</p>
                    </div>
                    <div id="email-result" style="margin-top:1rem;"></div>
                </form>
                
                <p><small>ì…ë ¥í•œ ì´ë©”ì¼ë¡œ ë¶„ì„ ê²°ê³¼ê°€ ì²¨ë¶€ëœ ë©”ì¼ì´ ë°œì†¡ë©ë‹ˆë‹¤. 
                    ì²¨ë¶€ íŒŒì¼ì—ëŠ” ê¸°íšì„œ(MD), ë””ìì¸ ë¶„ì„(JSON), ì¢…í•© ë³´ê³ ì„œ(PDF) ë“±ì´ í¬í•¨ë©ë‹ˆë‹¤.</small></p>
            </div>
        </div>
        
        <div class="grid" style="margin-top: 2rem;">
            <div>
                <a href="/download/{{ result_id }}/zip" role="button" class="primary">ì „ì²´ ê²°ê³¼ ë‹¤ìš´ë¡œë“œ (ZIP)</a>
            </div>
            <div>
                <a href="/" role="button" class="secondary outline">í™ˆìœ¼ë¡œ</a>
            </div>
        </div>
    </section>
</main>
{% endblock %}

{% block scripts %}
<script>
    // Alpine.jsê°€ ì´ë¯¸ íƒ­ ê´€ë¦¬ë¥¼ ì²˜ë¦¬í•˜ë¯€ë¡œ ì¶”ê°€ ìŠ¤í¬ë¦½íŠ¸ ë¶ˆí•„ìš”
    
    // ì´ë©”ì¼ ì „ì†¡ ì‘ë‹µ ì²˜ë¦¬
    document.body.addEventListener('htmx:afterSwap', function(event) {
        if (event.detail.target.id === 'email-result') {
            const result = event.detail.target;
            const response = JSON.parse(event.detail.xhr.responseText);
            
            if (response.status === 'success') {
                result.innerHTML = '<div class="alert alert-success">' + response.message + '</div>';
                // ì„±ê³µ ì‹œ í¼ ì´ˆê¸°í™”
                const form = result.closest('form');
                if (form) form.reset();
            } else {
                result.innerHTML = '<div class="alert alert-error">' + response.message + '</div>';
            }
        }
        
        // ë…¸ì…˜ ë‚´ë³´ë‚´ê¸° ì‘ë‹µ ì²˜ë¦¬
        if (event.detail.target.id === 'notion-export-result') {
            const result = event.detail.target;
            const response = JSON.parse(event.detail.xhr.responseText);
            
            result.style.display = 'block';
            
            if (response.status === 'success') {
                result.innerHTML = '<div class="alert alert-success">' + 
                    response.message + ' <a href="' + response.url + '" target="_blank">ë…¸ì…˜ í˜ì´ì§€ ì—´ê¸°</a></div>';
            } else {
                result.innerHTML = '<div class="alert alert-error">' + response.message + '</div>';
            }
            
            // 5ì´ˆ í›„ ì•Œë¦¼ ìˆ¨ê¸°ê¸°
            setTimeout(function() {
                result.style.display = 'none';
            }, 5000);
        }
        
        // êµ¬ê¸€ ë“œë¼ì´ë¸Œ ë‚´ë³´ë‚´ê¸° ì‘ë‹µ ì²˜ë¦¬
        if (event.detail.target.id === 'gdrive-export-result') {
            const result = event.detail.target;
            const response = JSON.parse(event.detail.xhr.responseText);
            
            result.style.display = 'block';
            
            if (response.status === 'success') {
                result.innerHTML = '<div class="alert alert-success">' + 
                    response.message + ' <a href="' + response.url + '" target="_blank">êµ¬ê¸€ ë“œë¼ì´ë¸Œ íŒŒì¼ ì—´ê¸°</a></div>';
            } else {
                result.innerHTML = '<div class="alert alert-error">' + response.message + '</div>';
            }
            
            // 5ì´ˆ í›„ ì•Œë¦¼ ìˆ¨ê¸°ê¸°
            setTimeout(function() {
                result.style.display = 'none';
            }, 5000);
        }
    });
</script>
{% endblock %} 